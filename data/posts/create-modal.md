---
id: 2
title: "NextJSì—ì„œ react portalì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë‹¬ë§Œë“¤ê¸°"
date: "2023-06-18"
category: "dev"
tags: ["#NextJS"]
---

ëª¨ë‹¬ì€ ì‚¬ìš©ìì™€ì˜ ìƒí˜¸ì‘ìš©ì„ í•˜ëŠ” UI ìš”ì†Œë¡œ ì›¹ì•±ì—ì„œ ì—†ì–´ì„œëŠ” ì•ˆ ë  ì¤‘ìš”í•œ ê¸°ëŠ¥ì…ë‹ˆë‹¤.

NextJS í™˜ê²½ì—ì„œ ì¬ì‚¬ìš©ì„±, UXì— ì¤‘ì ì„ ë§ì¶° ê°œë°œí•œ ëª¨ë‹¬ ì»´í¬ë„ŒíŠ¸ì— ëŒ€í•´ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.

## ğŸ“Œ êµ¬í˜„ ëª©í‘œ

1. [x] **ì¬ì‚¬ìš©ì„±**: ì¬ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë„ë¡ êµ¬í˜„í•©ë‹ˆë‹¤.

2. [x] **ì—´ê¸°, ë‹«ê¸°**: UI ìš”ì†Œë¥¼ í´ë¦­í•˜ì—¬ ëª¨ë‹¬ì„ ì—´ê±°ë‚˜, ë‹«ì„ ìˆ˜ ìˆë„ë¡ êµ¬í˜„í•©ë‹ˆë‹¤.

3. [x] **ë°±ê·¸ë¼ìš´ë“œ í´ë¦­ ë‹«ê¸°**: ì‚¬ìš©ìê°€ ëª¨ë‹¬ ë°°ê²½ì„ í´ë¦­í•˜ì—¬ ëª¨ë‹¬ì„ ë‹«ì„ ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.

4. [x] **í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬**: ESC í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë‹¬ì´ ë‹«íˆë„ë¡ í•©ë‹ˆë‹¤.

5. [ ] **í¬ì»¤ìŠ¤ ê´€ë¦¬**: ëª¨ë‹¬ì´ ì—´ë ¤ ìˆì„ ë•ŒëŠ” ëª¨ë‹¬ ë‚´ë¶€ì˜ ìš”ì†Œì— í¬ì»¤ìŠ¤ê°€ ì´ë™í•˜ë„ë¡ í•˜ë©°, ëª¨ë‹¬ì´ ë‹«í ë•ŒëŠ” ì´ì „ì— í¬ì»¤ìŠ¤ê°€ ìœ„ì¹˜í•œ ê³³ìœ¼ë¡œ í¬ì»¤ìŠ¤ê°€ ì´ë™ë˜ë„ë¡ ì²˜ë¦¬í•©ë‹ˆë‹¤.

6. [x] **ëª¨ë‹¬ ì™¸ë¶€ ìŠ¤í¬ë¡¤ ë§‰ê¸°**: ëª¨ë‹¬ì´ ì—´ë ¤ ìˆì„ ë•ŒëŠ” ëª¨ë‹¬ ì™¸ë¶€ì˜ ìŠ¤í¬ë¡¤ì„ ë§‰ì•„ ì‚¬ìš©ìê°€ ëª¨ë‹¬ ë‚´ìš© ì´ì™¸ì˜ ë¶€ë¶„ì„ ìŠ¤í¬ë¡¤ í•  ìˆ˜ ì—†ë„ë¡ í•©ë‹ˆë‹¤. ì´ëŠ” ëª¨ë‹¬ì´ ì‚¬ìš©ìì—ê²Œ í¬ì»¤ìŠ¤ë¥¼ ìœ ì§€í•˜ê³  ëª¨ë‹¬ ì™¸ë¶€ì˜ ì»¨í…ì¸ ì— ì˜í–¥ì„ ì£¼ì§€ ì•Šë„ë¡ ë„ì™€ì¤ë‹ˆë‹¤.

7. [ ] **ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼**: ëª¨ë‹¬ì˜ ì—´ê¸°/ë‹«ê¸° ì‹œì— ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ë¥¼ ì¶”ê°€í•˜ì—¬ ì‚¬ìš©ì ê²½í—˜ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

8. [ ] **ì ‘ê·¼ì„±**: ëª¨ë‹¬ì´ ì ‘ê·¼ì„± ìš”êµ¬ì‚¬í•­ì„ ì¶©ì¡±í•˜ë„ë¡ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” í¬ì»¤ìŠ¤ ê´€ë¦¬, í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬, ìŠ¤í¬ë¦° ë¦¬ë”ì™€ ê°™ì€ ë³´ì¡° ê¸°ìˆ  ì§€ì› ë“±ì„ í¬í•¨í•©ë‹ˆë‹¤. ëª¨ë‹¬ ë‚´ë¶€ì˜ í…ìŠ¤íŠ¸ ì»¨í…ì¸ ëŠ” ì½ê¸° ìˆœì„œì™€ ì ‘ê·¼ì„± ê´€ë ¨ ì†ì„±ì„ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.

## ğŸ“Œ ì»´í¬ë„ŒíŠ¸ ì„¤ëª…

```tsx
// Modal.tsx

"use client";

import React, { useEffect, useRef } from "react";
import ReactDOM from "react-dom";

interface IProps {
  children: React.ReactNode;
  onClose: () => void;
  isOpen: boolean;
}

const Modal: React.FC<IProps> = ({ children, isOpen, onClose }) => {
  const overlayRef = useRef<HTMLDivElement>(null);

  const overlayClickHandler = (event: React.MouseEvent<HTMLDivElement>) => {
    if (event.target === overlayRef.current) {
      onClose();
    }
  };

  useEffect(() => {
    const escKeyDownHandler = (event: KeyboardEvent) => {
      if (event.key === "Escape") {
        onClose();
      }
    };

    if (isOpen) {
      document.body.style.overflow = "hidden";
      document.addEventListener("keydown", escKeyDownHandler);
    } else {
      document.body.style.overflow = "auto";
      document.removeEventListener("keydown", escKeyDownHandler);
    }

    return () => {
      document.removeEventListener("keydown", escKeyDownHandler);
    };
  }, [isOpen, onClose]);

  if (typeof window === "undefined" || !isOpen) return null;

  const portalElement = document.getElementById("overlays") as Element;

  return ReactDOM.createPortal(
    <>
      <div
        className="fixed top-0 left-0 w-full h-screen z-40 bg-black bg-opacity-75"
        ref={overlayRef}
        onClick={overlayClickHandler}
      >
        <div className="fixed z-50 top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 p-4 bg-white rounded-lg shadow-md">
          {children}
        </div>
      </div>
    </>,
    portalElement
  );
};

export default Modal;
```

### 1. Props

í•´ë‹¹ ëª¨ë‹¬ì€ children, onClose, isOpen ì†ì„±ì„ ë°›ìŠµë‹ˆë‹¤.

**children**: ëª¨ë‹¬ ë‚´ë¶€ì— í‘œì‹œí•  ì»¨í…ì¸ ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.

**isOpen**: ëª¨ë‹¬ì˜ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” boolean ê°’ì…ë‹ˆë‹¤. ëª¨ë‹¬ì˜ on/offë¥¼ ê²°ì •í•©ë‹ˆë‹¤.

**onClose**: ëª¨ë‹¬ì„ ë‹«ëŠ” ë™ì‘ì„ ì²˜ë¦¬í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì „ë‹¬ë°›ìŠµë‹ˆë‹¤. í•´ë‹¹ í•¨ìˆ˜ëŠ” isOpen ìƒíƒœë¥¼ falseë¡œ ë³€ê²½í•˜ëŠ” ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

ì´ë ‡ê²Œ ì „ë‹¬ë˜ëŠ” propsë“¤ì„ í†µí•´ ëª¨ë‹¬ ì»´í¬ë„ŒíŠ¸ëŠ” ë™ì ìœ¼ë¡œ ì—´ë¦¬ê³  ë‹«íˆë©°, ë‚´ë¶€ ì»¨í…ì¸ ë¥¼ ë™ì ìœ¼ë¡œ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ëŸ¬í•œ êµ¬ì¡°ì ì¸ ì„¤ê³„ë¥¼ í†µí•´ ëª¨ë‹¬ ì»´í¬ë„ŒíŠ¸ëŠ” ì¬ì‚¬ìš©ì„±ì´ ë†’ì•„ì§€ë©°, ë‹¤ì–‘í•œ ìƒí™©ì—ì„œ ì¼ê´€ëœ ëª¨ë‹¬ ê²½í—˜ì„ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 2. ìŠ¤íƒ€ì¼ë§

ëª¨ë‹¬ì€ ë‘ ê°œì˜ div ìš”ì†Œë¡œ êµ¬ì„±ë©ë‹ˆë‹¤. ì²« ë²ˆì§¸ divëŠ” ë°±ê·¸ë¼ìš´ë“œë¡œ í´ë¦­í•˜ë©´ ëª¨ë‹¬ì´ ë‹«íˆëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. ë‘ ë²ˆì§¸ divëŠ” ëª¨ë‹¬ ì»¨í…ì¸ ë¥¼ ê°ì‹¸ê³  ìˆìœ¼ë©°, children ì†ì„±ì„ í†µí•´ ì „ë‹¬ëœ ì»¨í…ì¸ ë¥¼ ë Œë”ë§ í•©ë‹ˆë‹¤. Tailwind CSS í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤íƒ€ì¼ë§ì„ ì ìš©í–ˆìŠµë‹ˆë‹¤.

### 3. ë°±ê·¸ë¼ìš´ë“œ í´ë¦­ì‹œ ëª¨ë‹¬ ë‹«ê¸°

```tsx
const overlayRef = useRef<HTMLDivElement>(null);

const overlayClickHandler = (event: React.MouseEvent<HTMLDivElement>) => {
  if (event.target === overlayRef.current) {
    onClose();
  }
};
```

ëª¨ë‹¬ì€ ë‘ ê°œì˜ div ìš”ì†Œë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ divëŠ” ëª¨ë‹¬ì˜ ë°°ê²½ì„ ë‹´ë‹¹í•˜ë©°, ë‘ ë²ˆì§¸ divëŠ” ëª¨ë‹¬ì˜ ì»¨í…ì¸ ë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. í•´ë‹¹ ëª¨ë‹¬ì€ ì‚¬ìš©ìê°€ ë°°ê²½ ë¶€ë¶„ì„ í´ë¦­í•  ë•Œì—ë§Œ ë‹«í˜€ì•¼ í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ê¸°ë³¸ì ì¸ êµ¬í˜„ìœ¼ë¡œëŠ” ë°°ê²½ë¿ë§Œ ì•„ë‹ˆë¼ ì»¨í…ì¸ ë¥¼ í´ë¦­í•  ê²½ìš°ì—ë„ ëª¨ë‹¬ì´ ë‹«í˜€ë²„ë¦¬ëŠ” ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤.

ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ `useRef`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì°¸ì¡°ë¥¼ ìƒì„±í•˜ê³ , ì°¸ì¡°ë¥¼ ë°±ê·¸ë¼ìš´ë“œ divì— í• ë‹¹í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  overlayClickHandlerì—ì„œëŠ” ì´ë²¤íŠ¸ê°€ ë°œìƒí•œ ìš”ì†Œì™€ ì°¸ì¡°í•œ ìš”ì†Œê°€ ë™ì¼í•œì§€ ë¹„êµí•˜ì—¬, ë™ì¼í•  ê²½ìš°ì—ë§Œ ëª¨ë‹¬ì„ ë‹«ëŠ” í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

### 4. React Portalê³¼ NextJS

```tsx
ReactDOM.createPortal(ì „ì†¡í•  ìš”ì†Œ, ì „ì†¡ë  ê³³)
```

ReactDOM.createPortal ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë‹¬ì„ ë Œë”ë§ í•  ë…ë¦½ì ì¸ DOM ìš”ì†Œë¥¼ ì§€ì •í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë°©ì‹ì€ ëª¨ë‹¬ì˜ ì ‘ê·¼ì„± ìš”êµ¬ì‚¬í•­(í¬ì»¤ìŠ¤ ê´€ë¦¬, í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬, ìŠ¤í¬ë¦° ë¦¬ë” ë“±)ì„ ì¶©ì¡±ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx
if (typeof window === "undefined") return null;
```

`ReactDOM.createPortal` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë‹¬ì„ ë Œë”ë§ í•  DOM ìš”ì†Œë¥¼ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ëŸ¬ê¸° ìœ„í•´ì„œëŠ” DOM ê°ì²´ì— ì ‘ê·¼í•´ì•¼ í•˜ëŠ”ë° NextJSì—ì„œëŠ” ì„œë²„ ì¸¡ì—ì„œ ì‚¬ì „ë Œë”ë§ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ì´ë•Œ ì„œë²„ ì¸¡ì—ì„œ DOM ìš”ì†Œì— ì ‘ê·¼ì„ í•  ìˆ˜ ì—†ì–´ ì—ëŸ¬ê°€ ë°œìƒí•˜ê²Œ ë©ë‹ˆë‹¤. ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ `typeof window === "undefined"`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë²„ ì¸¡ì—ì„œ ë Œë”ë§ í•  ë•ŒëŠ” ëª¨ë‹¬ì„ ìˆ¨ê¹ë‹ˆë‹¤.

### 5. ëª¨ë‹¬ ì™¸ë¶€ ìŠ¤í¬ë¡¤ ë§‰ê¸°, ESC í‚¤ë¥¼ í†µí•´ ëª¨ë‹¬ ë‹«ê¸°

useEffect hookì„ ì‚¬ìš©í•˜ì—¬ isOpenì˜ ìƒíƒœì— ë”°ë¼ ESC í‚¤ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ê³  ì™¸ë¶€ ìŠ¤í¬ë¡¤ì„ ë§‰ìŠµë‹ˆë‹¤.

### 6. useModal custom hook

useModal ì»¤ìŠ¤í…€ í›…ì€ useState í›…ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë‹¬ì˜ ì—´ê¸°ì™€ ë‹«ê¸° ìƒíƒœë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤. ëª¨ë‹¬ì´ ì—´ë¦¬ê³  ë‹«íˆëŠ” ë° í•„ìš”í•œ í•¨ìˆ˜ë„ ì œê³µë©ë‹ˆë‹¤. ì´ í›…ì„ ì‚¬ìš©í•˜ë©´ ëª¨ë‹¬ì„ ë³´ë‹¤ ì‰½ê²Œ ì œì–´í•  ìˆ˜ ìˆìœ¼ë©° ì¬ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```tsx
"use client";

import { useState } from "react";

export const useModal = () => {
  const [isOpen, setIsOpen] = useState(false);

  const showModalHandler = () => {
    setIsOpen(true);
  };

  const closeModalHandler = () => {
    setIsOpen(false);
  };

  return { isOpen, showModalHandler, closeModalHandler };
};
```

## ğŸ“Œ ì‚¬ìš© ì˜ˆì‹œ

```tsx
const Test = () => {
  const { isOpen, showModalHandler, closeModalHandler } = useModal();

  return (
    <section>
      <Modal isOpen={isOpen} onClose={closeModalHandler}>
        <div className="p-5">ëª¨ë‹¬ ë™ì‘</div>
      </Modal>
      <button onClick={showModalHandler}>ëª¨ë‹¬ON</button>
    </section>
  );
};
```
